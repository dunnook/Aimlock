local rs = game:GetService("ReplicatedStorage")
local remote
local sell
local towerFolder
local towersPlaced
local placeHolder
local towers = {}
local postype = _G.settingtd["posType"]
for i, v in next, rs:GetDescendants() do
    if table.find({"Towers", "Tower"}, v.Name) and v:IsA("Folder") then
        towerFolder = v
    end
    if table.find({"SpawnTower", "PlaceTower", "Place"}, v.Name) and (v:IsA("RemoteEvent") or v:IsA("RemoteFunction")) then
        remote = v
    end
    if table.find({"SellTower"}, v.Name) and (v:IsA("RemoteEvent") or v:IsA("RemoteFunction")) then
        sell = v
    end
end
for i, v in next, workspace:GetDescendants() do
    if table.find({"Towers", "Tower"}, v.Name) and v:IsA("Folder") then
        towersPlaced = v
    end
end
if towerFolder == nil or remote == nil or sell == nil or towersPlaced == nil then
    warn("Need manual or script no work")
    return
end
if towersPlaced == nil then
    warn("Need manual for towers placed folder")
end
local modelCount_towerfolder = 0
local folderCount_towerfolder = 0
for i, v in next, towerFolder:GetChildren() do
    if v:IsA("Model") then
        modelCount_towerfolder += 1
    elseif v:IsA("Folder") then
        folderCount_towerfolder += 1
    end
end
if modelCount_towerfolder < folderCount_towerfolder then
    warn("Towers are folders")
    return
end
for i, v in next, towerFolder:GetChildren() do
    if v:IsA("Model") then
        local str = v.Name
        if v:FindFirstChild("Price", true) then
            str = str..", "..v:FindFirstChild("Price", true).Value
        end
        table.insert(towers, str)
    end
end
local args = {}
local Rayfield = loadstring(game:HttpGet('https://raw.githubusercontent.com/shlexware/Rayfield/main/source'))()
local Window = Rayfield:CreateWindow({
    Name = "Rayfield Example Window",
    LoadingTitle = "Rayfield Interface Suite",
    LoadingSubtitle = "by Sirius",
    ConfigurationSaving = {
        Enabled = false   ,
        FolderName = nil, -- Create a custom folder for your hub/game
        FileName = "Big Hub"
    },
    Discord = {
        Enabled = false,
        Invite = "noinvitelink", -- The Discord invite code, do not include discord.gg/. E.g. discord.gg/ABCD would be ABCD.
        RememberJoins = true -- Set this to false to make them join the discord every time they load it up
    },
    KeySystem = false, -- Set this to true to use our key system
    KeySettings = {
        Title = "Sirius Hub",
        Subtitle = "Key System",
        Note = "Join the discord (discord.gg/sirius)",
        FileName = "SiriusKey",
        SaveKey = true,
        GrabKeyFromSite = false, -- If this is true, set Key below to the RAW site you would like Rayfield to get the key from
        Key = "Hello"
    }
})
local Tab = Window:CreateTab("Tab Example", 4483362458) -- Title, Image

local Dropdown2 = Tab:CreateDropdown({
    Name = "Choose tower",
    Options = towers,
    CurrentOption = "None",
    Flag = "Dropdown2", -- A flag is the identifier for the configuration file, make sure every element has a different flag if you're using configuration saving to ensure no overlaps
    Callback = function(Option)
        local towerName = string.split(Option[1], ",")[1]
        args[1] = towerName or tostring(Option[1])
    end,
})
local Button1 = Tab:CreateButton({
Name = "Spawn Tower (May need money)",
Callback = function()
	args[2] = game:GetService("Players").LocalPlayer.Character.PrimaryPart[postype]
	if remote.ClassName == "RemoteFunction" then
        remote:InvokeServer(unpack(args))
    elseif remote.ClassName == "RemoteEvent" then
        remote:FireServer(unpack(args))
    else
        warn("Wrong path")
    end
end,
})
